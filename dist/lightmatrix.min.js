!function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):r.lightmatrix=n()}(this,function(){"use strict";function r(r){return Array.isArray(r)?r:Array.from(r)}var n=function(r){return"number"==typeof r&&!isNaN(r)},t=function(r){return 0===r?0:r},i=function(t){if(!(t instanceof Array)||0===t.length)return!1;for(var i=void 0,e=r(t).slice(0);e.length>0;){var o=e.shift();if(!(o instanceof Array))return!1;var a=o.length===(i=i||o.length),u=o.filter(function(r){return n(+(((t=r)instanceof Object||t)+""));var t}).length===i;if(!a||!u)return!1}return!0},e=function(r,n,i){for(var e=[],o=0;r.length>o;o+=1)if(o!==n){for(var a=[],u=0;r[0].length>u;u+=1)u!==i&&a.push(t(r[o][u]));e.push(a)}return e},o=function(n,i){for(var e=r(i).slice(0),o=[i.length,i[0].length],a=0;o[0]>a;a+=1)for(var u=0;o[1]>u;u+=1)e[a][u]=t(i[a][u]*n);return e},a={ok:i,dimension:function(r){if(this.ok(r))return[r.length,r[0].length];throw Error("Invalid matrix specification.")},unit:function(r){for(var n=r>=1&&r||2,t=[],i=0;n>i;i+=1){t[i]=[];for(var e=0;n>e;e+=1)t[i][e]=i===e?1:0}return t},equal:function(r,n){var t=this.dimension(r),i=this.dimension(n);if(t[0]!==i[0]||t[1]!==i[1])return!1;for(var e=0;t[0]>e;e+=1)for(var o=0;t[1]>o;o+=1)if(r[e][o]!==n[e][o])return!1;return!0},sum:function(r,n){if(!i(r)||!i(n))throw Error("Invalid matrix specification.");var e=[],o=[r.length,r[0].length],a=[n.length,n[0].length];if(o[0]!==a[0]||o[1]!==a[1])throw Error("Matrices not compatible.");for(var u=0;o[0]>u;u+=1){e[u]=[];for(var f=0;o[1]>f;f+=1)e[u][f]=t(r[u][f]+n[u][f])}return e},product:function(r,e){if(n(r)){if(n(e))return r*e;if(i(e))return o(r,e)}else if(i(r)){if(n(e))return o(e,r);if(i(e))return function(r,n){var i=[r.length,r[0].length],e=[n.length,n[0].length],o=[];if(i[1]===e[0]){for(var a=0;i[0]>a;a+=1){o[a]=[];for(var u=0;e[1]>u;u+=1){for(var f=0,s=0;i[1]>s;s+=1)f+=r[a][s]*n[s][u];o[a][u]=t(f)}}return o}throw Error("Matrices not compatible.")}(r,e)}throw Error("Invalid arguments supplied.")},transpose:function(r){for(var n=this.dimension(r).reverse(),i=[],e=0;n[0]>e;e+=1){i[e]=[];for(var o=0;n[1]>o;o+=1)i[e][o]=t(r[o][e])}return i},determinant:function(r){var n=void 0,t=this.dimension(r);if(t[0]!==t[1])throw Error("Square matrix required.");if(1===t[0])return r[0][0];for(var i=0;r[0].length>i;i+=1)n=n||0,n+=(0==(1&i)?1:-1)*r[0][i]*this.determinant(e(r,0,i));return n},minors:function(r){var n=this.dimension(r),i=[];if(n[0]!==n[1])throw Error("Square matrix required.");for(var o=0;n[0]>o;o+=1){i[o]=[];for(var a=0;n[0]>a;a+=1)i[o][a]=t(this.determinant(e(r,o,a)))}return i},cofactors:function(r){for(var n=this.dimension(r),i=this.minors(r),e=0;n[0]>e;e+=1)for(var o=0;n[0]>o;o+=1)i[e][o]=t(i[e][o]*(0==(e+o&1)?1:-1));return i},adjoint:function(r){return this.transpose(this.cofactors(r))},inverse:function(r){var n=this.determinant(r);if(0===n)throw Error("Cannot compute inverse of singular matrix.");return this.product(1/n,this.adjoint(r))}},u=function(r){return a[r].bind(a)};return{ok:u("ok"),valid:u("ok"),order:u("dimension"),dimension:u("dimension"),unit:u("unit"),identity:u("unit"),equal:u("equal"),same:u("equal"),sum:u("sum"),add:u("sum"),product:u("product"),multiply:u("product"),transpose:u("transpose"),determinant:u("determinant"),minors:u("minors"),cofactors:u("cofactors"),adjoint:u("adjoint"),inverse:u("inverse")}});
